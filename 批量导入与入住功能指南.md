# 学生批量导入与批量入住功能使用指南

---

## 一、学生批量导入功能使用指南

### 📋 功能概述

学生批量导入功能允许管理员通过Excel文件批量导入学生信息，自动校验数据格式和必填项，支持错误提示和批次管理，大大提高了学生信息录入效率。

### 🚀 快速开始

#### 1. 访问功能页面
- 登录系统后，在左侧菜单找到"学生管理" → "批量导入"
- 或者直接访问：`/studentImport`

#### 2. 下载Excel模板
- 点击页面右上角的"下载Excel模板"按钮
- 系统会自动下载标准格式的Excel模板文件

#### 3. 填写数据
按照模板格式填写学生信息：

| 字段名 | 必填 | 格式要求 | 示例 |
|--------|------|----------|------|
| 学号   | 是   | 唯一，不能为空 | 20230001 |
| 姓名   | 是   | 2-20位中英文、·、-、空格，不能全为数字 | 张三 |
| 性别   | 是   | 男或女 | 男 |
| 年龄   | 是   | 15~100的整数 | 18 |
| 手机号 | 否   | 合法手机号 | 13800000000 |
| 邮箱   | 否   | 合法邮箱 | zhangsan@example.com |

#### 4. 上传文件
- 点击"上传Excel文件"按钮
- 选择填写好的Excel文件
- 点击"上传"按钮

#### 5. 数据预览
- 上传成功后，系统会显示数据预览
- 检查数据是否正确
- 点击"验证数据"按钮

#### 6. 数据验证
- 系统会自动验证所有数据的有效性
- 查看验证结果和错误信息
- 如有错误，请修正后重新上传

#### 7. 执行导入
- 选择处理策略：
  - **继续处理**：遇到错误时跳过该条记录，继续处理其他记录
  - **全部回滚**：遇到任何错误时，整个批次全部回滚
- 点击"执行导入"按钮

### 📑 模板字段与填写说明

- **学号**：必填，唯一，不能为空。
- **姓名**：必填，2-20位，仅限中英文、·、-、空格，不能全为数字。
- **性别**：必填，只能为"男"或"女"。
- **年龄**：必填，必须为15~100之间的整数。
- **手机号**：可选，如填写必须为合法手机号。
- **邮箱**：可选，如填写必须为合法邮箱。

#### 模板示例

| 学号   | 姓名 | 性别 | 年龄 | 手机号      | 邮箱                |
|--------|------|------|------|-------------|---------------------|
| 20230001 | 张三 | 男   | 18   | 13800000000 | zhangsan@example.com |

### 🔍 数据验证规则

- 学号、姓名、性别、年龄为必填，学号唯一
- 姓名2-20位中英文、·、-、空格，不能全为数字
- 性别为"男"或"女"
- 年龄为15~100的整数
- 手机号、邮箱如填写需为合法格式

### ⚠️ 常见错误及解决方案

#### 1. 学号重复或为空
**错误信息**：学号不能为空/学号已存在
**解决方案**：检查学号唯一性和填写完整

#### 2. 姓名格式不合法
**错误信息**：姓名格式不合法
**解决方案**：仅填写中英文、·、-、空格，2-20位，不能全为数字

#### 3. 性别或年龄不合法
**错误信息**：性别必须为男或女/年龄必须为15~100之间的整数
**解决方案**：按模板要求填写

#### 4. 手机号/邮箱格式错误
**错误信息**：手机号格式不正确/邮箱格式不正确
**解决方案**：填写合法手机号/邮箱，或留空

### 📁 文件要求

- 支持格式：`.xlsx`
- 最大文件大小：10MB
- 编码格式：UTF-8
- 第一行为表头，从第二行开始为数据，空行会被自动跳过

### 🔧 技术说明

- 支持Excel 2007及以上版本
- 小文件（<1MB）：处理时间通常<5秒
- 大文件（5-10MB）：处理时间通常<2分钟

### 🆘 故障排除

- 检查文件格式、大小、网络连接
- 检查必填字段和数据格式
- 查看具体错误信息

### 📞 技术支持

如遇到问题，请联系系统管理员或技术支持团队。

---

## 二、批量入住功能使用指南

# 批量入住功能使用指南

## 📋 功能概述

批量入住功能允许管理员和宿管通过Excel文件批量处理学生入住，大大提高了工作效率。支持数据验证、错误处理和权限控制。

## 🚀 快速开始

### 1. 访问功能页面
- 登录系统后，在左侧菜单找到"住宿管理" → "批量入住"
- 或者直接访问：`/batchCheckin`

### 2. 下载Excel模板
- 点击页面右上角的"下载Excel模板"按钮
- 系统会自动下载标准格式的Excel模板文件

### 3. 填写数据
按照模板格式填写学生入住信息：

| 字段名 | 必填 | 格式要求 | 示例 |
|--------|------|----------|------|
| 学号 | 是 | 系统中存在的学生学号 | 2021001 |
| 学生姓名 | 是 | 与学号匹配的学生姓名 | 张三 |
| 房间号 | 是 | 4位数字，第1位为楼栋号 | 1001 |
| 床位号 | 是 | 1-4之间的数字 | 1 |
| 备注 | 否 | 可选说明信息 | 新生入住 |

### 4. 上传文件
- 点击"上传Excel文件"按钮
- 选择填写好的Excel文件
- 点击"上传"按钮

### 5. 数据预览
- 上传成功后，系统会显示数据预览
- 检查数据是否正确
- 点击"验证数据"按钮

### 6. 数据验证
- 系统会自动验证所有数据的有效性
- 查看验证结果和错误信息
- 如有错误，请修正后重新上传

### 7. 执行入住
- 选择处理策略：
  - **继续处理**：遇到错误时跳过该条记录，继续处理其他记录
  - **全部回滚**：遇到任何错误时，整个批次全部回滚
- 点击"执行入住"按钮

## 🔍 数据验证规则

### 学号验证
- 学号必须在系统中存在
- 学号与学生姓名必须匹配

### 房间验证
- 房间号必须存在
- 房间号格式：4位数字，第1位为楼栋号
- 宿管只能操作自己管理楼栋的房间

### 床位验证
- 床位号必须在1-4之间
- 床位必须未被占用
- 学生不能重复入住

### 权限验证
- 管理员可以操作所有楼栋
- 宿管只能操作自己管理的楼栋

## ⚠️ 常见错误及解决方案

### 1. 学号不存在
**错误信息**：学号不存在
**解决方案**：
- 检查学号是否正确
- 确认学生信息已录入系统

### 2. 学生已有宿舍
**错误信息**：学生已有宿舍
**解决方案**：
- 先为学生办理退宿手续
- 或选择其他学生

### 3. 房间不存在
**错误信息**：房间不存在
**解决方案**：
- 检查房间号是否正确
- 确认房间信息已录入系统

### 4. 床位已被占用
**错误信息**：床位已被占用
**解决方案**：
- 选择其他床位
- 或选择其他房间

### 5. 权限不足
**错误信息**：房间不在您的管辖范围内
**解决方案**：
- 宿管只能操作自己管理的楼栋
- 联系管理员处理其他楼栋

## 📊 批次管理

### 查看批次列表
- 在批量入住页面可以看到所有批次记录
- 显示批次号、操作人、总数量、成功数量、失败数量、状态等信息

### 批次状态说明
- **待处理**：批次已创建，等待执行
- **处理中**：正在执行批量入住
- **已完成**：批量入住执行完成
- **失败**：批量入住执行失败

### 查看详情
- 点击"查看详情"按钮可以查看批次的具体信息
- 包括每个学生的处理结果和错误信息

## 🛠️ 处理策略

### 继续处理策略
- 遇到错误时跳过该条记录
- 继续处理其他记录
- 适合大部分数据正确的情况
- 最终会显示成功和失败的数量

### 全部回滚策略
- 遇到任何错误时，整个批次全部回滚
- 确保数据的一致性
- 适合数据完整性要求高的情况
- 要么全部成功，要么全部失败

## 📁 文件要求

### 文件格式
- 支持格式：`.xlsx`
- 不支持格式：`.xls`、`.csv`等

### 文件大小
- 最大文件大小：10MB
- 建议单次处理不超过1000条记录

### 编码格式
- 文件编码：UTF-8
- 确保中文字符正确显示

## 🔧 技术说明

### 支持的Excel版本
- Excel 2007及以上版本
- 使用`.xlsx`格式

### 数据格式要求
- 第一行为表头（会被忽略）
- 从第二行开始为数据
- 空行会被自动跳过

### 性能说明
- 小文件（<1MB）：处理时间通常<5秒
- 中等文件（1-5MB）：处理时间通常<30秒
- 大文件（5-10MB）：处理时间通常<2分钟

## 🆘 故障排除

### 上传失败
1. 检查文件格式是否为`.xlsx`
2. 检查文件大小是否超过10MB
3. 检查网络连接是否正常
4. 刷新页面后重试

### 验证失败
1. 检查Excel文件格式是否正确
2. 检查必填字段是否已填写
3. 检查数据格式是否符合要求
4. 查看具体的错误信息

### 执行失败
1. 检查数据验证是否通过
2. 检查数据库连接是否正常
3. 查看系统日志获取详细错误信息
4. 联系系统管理员

## 📞 技术支持

如遇到问题，请联系系统管理员或技术支持团队。

## 📑 模板字段与填写说明

请严格按照模板格式填写数据，不要更改表头。

- **学号**：必须为系统中已存在的学生学号。
- **学生姓名**：系统会自动验证学号与姓名是否匹配。
- **房间号**：前N位为楼栋ID，后3位为房间号（如：11101表示11号楼101房间）备注：楼栋ID为楼宇信息中表中编号。
- **床位号**：1-4之间的数字，表示房间内的床位编号。
- **备注**：可选字段，用于记录特殊说明。

### 模板示例

| 学号   | 学生姓名 | 房间号 | 床位号 | 备注     |
|--------|----------|--------|--------|----------|
| 2021001 | 张三     | 11101  | 1      | 新生入住 |
| 2021002 | 李四     | 11101  | 2      | 新生入住 |

如需进一步合并或调整其他部分内容，请告知！

---

**版本**：v1.0  
**更新日期**：2025年7月  
**作者**：宿舍管理系统开发团队 